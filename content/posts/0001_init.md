+++
date = '2025-06-26T11:07:33+09:00'
draft = false
title = 'GitHub Pagesによる技術ブログを始めます'
+++

## はじめに

長らく記事の投稿には[butterfly dream (はてなブログ)](https://chaploud-blog.hatenablog.com/)を使っていたのですが、Markdownをコピペすれば動くものでもなく、独自UIに依存してしまうので、GitHub Pagesに技術記事を移行することにしました。欠点はSEOが弱くなることですが、元々多くの人に読まれることを想定していないので私にとっては特に問題ありません。GitHub Pagesで技術ブログ(サイト)を投稿することの利点を挙げます。

- Git管理ができる
  - これが一番ありがたいです
- プレインテキストで記述できる
  - Git管理とも関連しますが、静的サイトジェネレータ(SSG)を使えばきれいなサイトとしてレンダリングされますし、生成AIからも情報源として扱いやすくなったりします
- 直接htmlを置ける
  - よくあるブログサービスではどの記事も基本的には同じフォーマットですが、何か動くものとか生成AIに作らせたページをそのまま置きたい場合にはhtmlファイルを直接置けた方がいいです

## hugoの紹介

このサイトは[hugo](https://github.com/gohugoio/hugo)を使って作成しています。いわゆるSSGです。歴史などは詳しい記事にゆずるとして、本サイトがどのように作られているかを説明します。

### (1) hugoの導入

私はWindowsのWSL2上で開発をしていますので、WSL2 (Ubuntu 24.04)前提です。

```sh
# どちらかでOK
# snapを使うなら
sudo snap install hugo
# Homebrewを使うなら
brew install hugo
```

### (2) ひな形を作る

```sh
hugo new site <任意のディレクトリ名> # 以下 `blog` とする
cd blog
```

ひな形のディレクトリやファイルが生成されます

### (3) Git管理を開始する

- リポジトリ初期化

```sh
git init
```

- 空のディレクトリに `.gitkeep` を配置(こうしないと空ディレクトリはコミットされない)

```sh
find . -type d -exec touch {}/.gitkeep \;
rm archetypes/.gitkeep # すでにdefault.mdがあるので不要
```

```sh
git add .
git commit -m "最初のコミット"
```

### (4) テーマを入れる

ここでは有名な[PaperMod](https://github.com/adityatelange/hugo-PaperMod.git)テンプレートを使います。

```sh
# サブモジュールとして入れたい場合は以下
# サブモジュールに含めたくない場合は手動でダウンロードして配置
git clone https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod
```

### (5) 設定を行う

`hugo.toml` に以下のような記述をする

```toml
baseURL = 'https://chaploud.github.io/blog/'
languageCode = 'ja'
title = 'chaploud dev notes'
theme = 'PaperMod' # themes内に入れたテーマ

[params]
ShowReadingTime = true
ShowShareButtons = true
ShowPostNavLinks = true
ShowBreadCrumbs = true
ShowCodeCopyButtons = true
# トップページに一覧したい記事を格納するディレクトリを指定
mainSections = ["posts"]
```

この他にもさまざまな設定があるので、詳しくは[All settings](https://gohugo.io/configuration/all/)を参照

### (6) トップページを作成する

例えば、<https://github.com/chaploud/blog>にこのリポジトリを置いてGitHub Pagesで公開すると、以下のURLで見れます。

<https://chaploud.github.io/blog/>

この際に描画されるトップページは、`content/_index.md`が対応します。これを作成して内容を記述してください。

`_index.md` の一例

```markdown
+++
title = 'chaploud dev notes'
+++

# ブログへようこそ

技術的な学びや日常の記録を綴っています。

最新の投稿をぜひご覧ください。
```

### (7) ブログポストを作成する

```sh
hugo new posts/<記事のファイル名>.md
```

`archetypes/default.md`をテンプレートとした記事ファイルが作成されます。これに記述。

### (8) 固定ページを作成する

ブログの投稿ではなく、固定ページとして運用したい場合は、`content/pages` ディレクトリなどを作成して、そこにテンプレートを使わない`.md`ファイルを置きます。

### (9) htmlファイルを直置きする

`.md`ファイルではなく`.html`ファイルを直置きしたい場合は、`static`ディレクトリ以下に置きます。

### (10) 手元で動作確認する

以下のコマンドで表示されたURLにアクセスして確認する。

```sh
hugo server -D # -Dがないと、`+++`で囲まれた設定の`draft = false`のみが表示されます
```

### (11) 各種リンクの書き方

- `.md`から生成されるページへのリンク

```markdown
[About Page]({{</* ref "./pages/about.md" */>}})
```

- 直置きしたindex (`static/some-dir/sampe.html`)へのリンク

```markdown
[サンプルページ](/blog/some-dir/sample.html)
```

- 外部URL: 通常通りのURLで書けばOK

```markdown
[Google](https://google.com)
```

### (12) GitHub Actionsを設定する

```sh
mkdir -p .github/workflows
touch .github/workflows/hugo.yml # 以下を記述
```

```yml
name: Deploy Hugo site to Pages

on:
  push:
    branches:
      - main
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

defaults:
  run:
    shell: bash

jobs:
  build:
    runs-on: ubuntu-latest
    env:
      HUGO_VERSION: 0.147.9
    steps:
      - name: Install Hugo CLI
        run: |
          wget -O ${{ runner.temp }}/hugo.deb https://github.com/gohugoio/hugo/releases/download/v${HUGO_VERSION}/hugo_extended_${HUGO_VERSION}_linux-amd64.deb \
          && sudo dpkg -i ${{ runner.temp }}/hugo.deb
      - name: Checkout
        uses: actions/checkout@v4
      - name: Setup Pages
        id: pages
        uses: actions/configure-pages@v4
      - name: Build with Hugo
        env:
          HUGO_ENVIRONMENT: production
          HUGO_ENV: production
        run: |
          hugo \
            --gc \
            --minify \
            --baseURL "${{ steps.pages.outputs.base_url }}/"
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./public

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```

